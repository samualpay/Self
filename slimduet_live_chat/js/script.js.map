{"version":3,"sources":["script.js"],"names":["addEventListener","setTimeout","hideURLbar","window","scrollTo","$","queryString","Qs","parse","location","search","slice","console","log","langs","langCode","lang","indexOf","getJSON","translate","jsonData","attr","token","each","str","html","name","val","gender","email","initFormData","formValidation","validateEmail","re","test","$emailError","$submit","$name","$gender","$email","undefined","css","keyup","change","on","$uid","uid","$appId","appId","$lang","tjName","en","zh","TJ_IM","config","data","key","value"],"mappings":"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","file":"script.js","sourcesContent":["'use strict';\r\n\r\naddEventListener(\"load\", function () {\r\n    setTimeout(hideURLbar, 0);\r\n}, false);\r\n\r\nfunction hideURLbar() {\r\n    window.scrollTo(0, 1);\r\n}\r\n\r\n$(function () {\r\n    var queryString = Qs.parse(location.search.slice(1));\r\n    console.log(queryString);\r\n\r\n    var langs = ['en', 'zh'],\r\n        langCode = queryString.lang;\r\n\r\n    if (langs.indexOf(langCode) !== -1)\r\n        $.getJSON('lang/' + langCode + '.json', translate);\r\n    else\r\n        $.getJSON('lang/en.json', translate);\r\n\r\n    function translate(jsonData) {\r\n        $('#TJ_IMScript').attr(\"data-token\", jsonData.token);\r\n        $('[key]').each(function () {\r\n            var str = jsonData[$(this).attr('key')];\r\n            $(this).html(str);\r\n        });\r\n        $('#name').attr(\"placeholder\", jsonData.name);\r\n    }\r\n\r\n    $('#name').val(queryString.name);\r\n    $(':radio[name=\"gender\"][value=\"' + queryString.gender + '\"]').attr(\"checked\", true);\r\n    $('#email').val(queryString.email);\r\n\r\n    function initFormData() {\r\n        formValidation()\r\n    }\r\n\r\n    initFormData();\r\n\r\n    function validateEmail(email) {\r\n        var re = /^[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?$/;\r\n\r\n        return re.test(email);\r\n    }\r\n\r\n    function formValidation() {\r\n        var $emailError = $('#emailError'),\r\n            $submit = $('button[type=\"submit\"]'),\r\n            $name = $('#name').val(),\r\n            $gender = $('input[name=\"gender\"]:checked').val(),\r\n            $email = $('#email').val();\r\n\r\n        if (($name != '' && $gender != undefined) && (validateEmail($email) || $email == '')) {\r\n            $submit.attr('disabled', false);\r\n        } else {\r\n            $submit.attr('disabled', true);\r\n        }\r\n\r\n        if (validateEmail($email) || $email == '') {\r\n            $emailError.css({\r\n                'display': 'none'\r\n            });\r\n        } else {\r\n            $emailError.css({\r\n                'display': 'block'\r\n            });\r\n        }\r\n    }\r\n\r\n    $('#name').keyup(function () {\r\n        console.log($('#name').val());\r\n        formValidation();\r\n    })\r\n\r\n    $('input[name=\"gender\"]').change(function () {\r\n        console.log($('input[name=\"gender\"]:checked').val());\r\n        formValidation();\r\n    })\r\n\r\n    $('#email').keyup(function () {\r\n        console.log($('#email').val())\r\n        formValidation();\r\n    })\r\n\r\n    $('#connect').on('click', function () {\r\n        var $uid = queryString.uid,\r\n            $appId = queryString.appId,\r\n            $lang = queryString.lang,\r\n            $name = $('#name').val(),\r\n            $gender = $(':radio[name=\"gender\"]:checked').val(),\r\n            $email = $('#email').val();\r\n        \r\n        if(!$uid) $uid = 'unknown';\r\n        if(!$appId) $appId = 'global_website';\r\n\r\n        var tjName = {\r\n            en: {\r\n                appId: 'APP ID',\r\n                gender: 'Gender',\r\n                email: 'Email'\r\n            },\r\n            zh: {\r\n                appId: 'APP编号',\r\n                gender: '性别',\r\n                email: '邮件'\r\n            }\r\n        }\r\n\r\n        var appId = '',\r\n            gender = '',\r\n            email = '';\r\n\r\n        if ($lang == 'zh') {\r\n            appId = tjName.zh.appId;\r\n            gender = tjName.zh.gender;\r\n            email = tjName.zh.email;\r\n        } else {\r\n            appId = tjName.en.appId;\r\n            gender = tjName.en.gender;\r\n            email = tjName.en.email;\r\n        }\r\n        \r\n        console.log('appId, gender, email', appId, gender, email)\r\n\r\n        console.log($appId, $uid, $name, $gender, $email);\r\n\r\n        TJ_IM.config({\r\n            uid: $uid, //客户ID（用户号=註冊號），必填\r\n            name: $name, //客户名称（姓名），必填\r\n            data: [ //其他数据，数据属性有三个key，name，value\t\t\t\t\r\n                {\r\n                    key: 'appId', //属性字段名\r\n                    name: appId, //客服工作台显示的属性名称\r\n                    value: $appId //显示的属性值\r\n                },\r\n                {\r\n                    key: 'gender',\r\n                    name: gender,\r\n                    value: $gender\r\n                },\r\n                {\r\n                    key: 'email',\r\n                    name: email,\r\n                    value: $email\r\n                }\r\n            ]\r\n        })\r\n    })\r\n});"]}